<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Air puri | 고객 센터</title>
		<% include head.ejs %>
	</head>

<body>
	<div id="app">
	<!-- Start Content -->
	<section id="contact" class="wrapper">

		<!-- Start Header -->
		<header  class="page-header-container">
			<div class="container-fluid page-header-content">
				<div class="page-overlay"></div>
					<h2>고객 센터</h2>
				</div>
		</header>
		<!-- End Header -->

		<% include navbar.ejs %>
		<section class="block">
			<div class="container">
				<p class="text-center">
					<button style="cursor:pointer;" type="button" v-on:click="reg_sn" class="button order-button ld-over-inverse">제품 번호 등록<div class="ld ld-ring ld-spin-fast"></div></button>
				</p>
				<br />
				<h3 class="text-center">FAQ</h3>
				<div id="accordion">
				  <div class="card">
				    <div class="card-header" id="headingOne">
				      <h5 class="mb-0">
				        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
				          	질문 1
				        </button>
				      </h5>
				    </div>
				
				    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
				      <div class="card-body">
				        	답변 1
				      </div>
				    </div>
				  </div>
				  <div class="card">
				    <div class="card-header" id="headingTwo">
				      <h5 class="mb-0">
				        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
				          Collapsible Group Item #2
				        </button>
				      </h5>
				    </div>
				    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
				      <div class="card-body">
				        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
				      </div>
				    </div>
				  </div>
				  <div class="card">
				    <div class="card-header" id="headingThree">
				      <h5 class="mb-0">
				        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
				          Collapsible Group Item #3
				        </button>
				      </h5>
				    </div>
				    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
				      <div class="card-body">
				        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
				      </div>
				    </div>
				  </div>
				</div>
			</div>
		</section>
		<!-- End Navigation -->
		<div id="map" style="width:100%; height: 400px;"></div>
		<!-- Start Content -->
		<section id="content" class="page-container">
			<div class="container">
				<div class="row">

					<div class="col-md-8 page-content">
						<p>카카오톡 친구 찾기에서 <strong>에어퓨리</strong>로 검색 혹은 하단의 메일로 문의주시면 실시간 상담이 가능합니다.<br /></p>
						<h3>운영 시간</h3>
						<p>
							09:00 ~ 18:00 (공휴일 휴무)
						</p>
						<ul>
							<li><strong>Phone:</strong> (+11) 123-555-4567</li>
							<li><strong>Email:</strong> mail@example.com</li>
							<li><strong>Address:</strong> 1465 Mountain St, CA 91104, USA</li>
						</ul>
									
						<!-- Start Order Form -->
								<div class="contact-form">
									<div class="row">
										<p class="col-lg-6 col-md-12">
											<input v-on:input="update_send_name" type="text" class="order-f-name" style="width:100%;margin-top:0px;"  placeholder="이름">
										</p>
										<p class="col-lg-6 col-md-12">
											<input v-on:input="update_recieve_email" type="text" class="order-email" style="width:100%;margin-top:0px;" placeholder="답장 받을 이메일">
										</p>
										<p class="col-lg-12 col-md-12">
											<input v-on:input="update_title" type="text" class="order-title" style="width:100%; margin-top:0px;" placeholder="제목">
										</p>
										<p class="col-lg-12">
											<textarea v-on:input="update_content" cols="40" rows="6" class="order-address" style="width:100%; border: 2px solid #43bccd; background-color:#f2f2f2" placeholder="내용"></textarea>
										</p>
										<p class="col-lg-12 text-center order-button-block">
											<button v-on:click="req_email" style="cursor:pointer;" type="button" class="button order-button ld-over-inverse">보내기<div class="ld ld-ring ld-spin-fast"></div></button>
										</p>
									</div>
								</div>
						<!-- End Order Form -->
					</div>
				</div>
				
			</div>
			
		</section>
		<!-- End Content -->
		<% include footer.ejs %>
	</section>
	<!-- End Content -->
	<% include popup.ejs %>
	<!-- Start Popup -->
	<section id="snreg" class="order mfp-hide">

		<div class="order-form-content">

			<!-- Start Order Form -->
			<div class="order-form">
				<div class="col-md-12">
					<h3>제품 번호 등록</h3>
				</div>
				<div class="col-md-12">
					<input class="order-email" type="text" name="email" v-model="serialNumber" placeholder="제품 번호를 입력해 주세요">
				</div>
				<div class="col-md-12">
					<label>{{ findPWMessage }}</label>
				</div>
				<div class="col-md-12">
					<hr>
				</div>
				<div class="col-md-6">
					<button type="button" style="width:100%; margin-top:10px;" v-on:click="req_sn" class="button  ld-over-inverse action-button-cta" >등록 하기<div class="ld ld-ring ld-spin-fast"></div></button>
				</div>
			</div>
			<!-- End Order Form -->

		</div> <!-- .order-form-content -->

	</section>
	<!-- End Popup -->
</div>
<!-- Include JS -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/device.min.js"></script>
<script src="assets/js/retina.min.js"></script>
<script src="assets/js/nav.js"></script>
<script src="assets/js/smooth-scroll.min.js"></script>
<script src="assets/js/parallax.js"></script>
<script src="assets/js/aos.js"></script>
<script src="assets/js/flexslider.js"></script>
<script src="assets/js/youtubebackground.js"></script>
<script src="assets/js/magnific-popup.min.js"></script>
<script src="assets/js/init.js"></script>
<script>
     function initMap() {
       // Create a map object and specify the DOM element for display.
       var map = new google.maps.Map(document.getElementById('map'), {
         center: {lat: 37.548354, lng: 126.918951},
         zoom: 18
       });

       // Create a marker and set its position.
       var marker = new google.maps.Marker({
         map: map,
         position: {lat: 37.548354, lng: 126.918951},
         title: '고객센터 위치'
       });
     }
</script>
<!-- google Map API -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGpvUrTIpP7UhQut7omRAUpqz-9MBacpQ&callback=initMap" async defer></script>
<% include init.ejs %>
<!-- vue.js 부분 -->
<script type="text/javascript">
new Vue({
	el:'#app',
	data:{
		send_name:'',
		recieve_email:'',
		title:'',
		content:'',
		user:null,
		loginEmailInput:'',
		loginPwInput:'',
		signUpEmailInput:'',
		signUpPwInput:'',
		signUpPwConfirmInput:'',
		signUpNicknameInput:'',
		signUpMessage:'',
		loginMessage:'',
		findPWMessage :'',
		findEmail:'',
		serialNumber:'',
		anonyEmail:'',
		anonyPw:''
	},
	methods:{
		showModal: function(){
			$.magnificPopup.open({
				items:{
					src:'#order'
				},
				type:'inline',
			    midClick: true,
			    removalDelay: 300,
			    mainClass: 'mfp-fade'
			});
		},
		update_send_name:function(e){
			this.send_name = e.target.value;
		},
		update_recieve_email:function(e){
			this.recieve_email = e.target.value;
		},
		update_title:function(e){
			this.title = e.target.value;
		},
		update_content:function(e){
			this.content = e.target.value;
		},
		reg_sn:function(e){
			const vm = this;
			if(this.user==null){
				alert("로그인 후에 이용 가능합니다.")
			} else{
				$.magnificPopup.open({
					items:{
						src:'#snreg'
					},
					type:'inline',
				    midClick: true,
				    mainClass: 'mfp-fade',
				    callbacks:{
					    close: function(){
					    	vm.serialNumber='';
					    }
				    }
				});
			}
		},
		req_sn:function(e){
			var $button=$(e.target);
			$button.addClass("running");
			var vm = this;
			this.user.getIdToken(true).then(function(idToken) {
				$.post('/contact/reg_sn' , {sn:vm.serialNumber, token:idToken}, function(result){
						alert("등록이 완료되었습니다.");
						$button.removeClass("running");
						$.magnificPopup.close();
					}).fail(function(err){
						$button.removeClass("running");
						if(err['message']=='duplicate'){
							alert("이미 등록된 제품번호 입니다. 고객센터로 문의주세요!")
						} else{
							alert("내부 서버 오류입니다. 잠시후에 다시 시도 해 주세요!");
						}
					});
				}).catch(function(error) {
					alert("내부 서버 오류입니다. 잠시후에 다시 시도 해 주세요!");
				});
		},
		req_email:function(e){
			var $button=$(e.target);
			$button.addClass("running");
			var emailRegExp = /([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
			var name = this.send_name.trim();
			var email = this.recieve_email.trim();
			var email_subject = this.title.trim();
			var message = this.content.trim();
			if(name == ''){
				alert("이름을 입력 해 주세요");
				$button.removeClass("running");
			} else if(!emailRegExp.test(email)){
				alert("올바른 형식의 이메일을 입력해 주세요");
				$button.removeClass("running");
			} else if(email_subject==''){
				alert("이메일 제목을 입력해 주세요");
				$button.removeClass("running");
			} else if(message==''){
				alert("이메일 내용을 입력해 주세요");
				$button.removeClass("running");
			}else{
				$.post('/contact/send_mail' , {name:name , email: email, subject : email_subject, content: message}, function(result){
					alert("발송이 완료되었습니다.");
					$button.removeClass("running");
				}).fail(function(){
					$button.removeClass("running");
					alert("내부 서버 오류입니다. 잠시후에 다시 시도 해 주세요!");
				});
			}
		},
		<% include navbar.js%>
	},
	beforeCreate: function(){
		Kakao.init('8cfff2d2abaa58507a1576a56585356c');
		firebase.auth().onAuthStateChanged((user) => {
	        if (user) {
	          this.user = user
	        }
	      });
	},
	created: function(){
		
	}
});
</script>

</body>
</html>